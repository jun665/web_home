

class UseN18 {

    enUS = {
        left: {
            addChat: 'New Chat',
            newChat: 'New Chat',
            noChat: 'Not Data',
            promptStore: 'Prompt Store',
            noMessage: 'Aha~',
        },
        common: {
            add: 'Add',
            addSuccess: 'Add Success',
            edit: 'Edit',
            editSuccess: 'Edit Success',
            delete: 'Delete',
            deleteSuccess: 'Delete Success',
            save: 'Save',
            saveSuccess: 'Save Success',
            reset: 'Reset',
            action: 'Action',
            export: 'Export',
            exportSuccess: 'Export Success',
            import: 'Import',
            importSuccess: 'Import Success',
            clear: 'Clear',
            clearSuccess: 'Clear Success',
            yes: 'Yes',
            no: 'No',
            confirm: 'Confirm',
            download: 'Download',
            noData: 'No Data',
            wrong: 'Something went wrong, please try again later.',
            success: 'Success',
            failed: 'Failed',
            verify: 'Verify',
            unauthorizedTips: 'Unauthorized, please verify first.',
        },
        chat: {
            placeholder: 'Ask me anything...(Shift + Enter = line break)',
            placeholderMobile: 'Ask me anything...',
            copy: 'Copy',
            copied: 'Copied',
            copyCode: 'Copy Code',
            clearChat: 'Clear Chat',
            stopChat: 'Stop Response',
            clearChatConfirm: 'Are you sure to clear this chat?',
            exportImage: 'Export Image',
            exportImageConfirm: 'Are you sure to export this chat to png?',
            exportSuccess: 'Export Success',
            exportFailed: 'Export Failed',
            usingContext: 'Context Mode',
            turnOnContext: 'In the current mode, sending messages will carry previous chat records.',
            turnOffContext: 'In the current mode, sending messages will not carry previous chat records.',
            deleteMessage: 'Delete Message',
            deleteMessageConfirm: 'Are you sure to delete this message?',
            deleteHistoryConfirm: 'Are you sure to clear this history?',
            clearHistoryConfirm: 'Are you sure to clear chat history?',
            preview: 'Preview',
            showRawText: 'Show as raw text',
        },
        setting: {
            setting: 'Setting',
            general: 'General',
            advanced: 'Advanced',
            config: 'Config',
            avatarLink: 'Avatar Link',
            name: 'Name',
            description: 'Description',
            role: 'Role',
            resetUserInfo: 'Reset UserInfo',
            chatHistory: 'ChatHistory',
            theme: 'Theme',
            language: 'Language',
            api: 'API',
            reverseProxy: 'Reverse Proxy',
            timeout: 'Timeout',
            socks: 'Socks',
            httpsProxy: 'HTTPS Proxy',
            balance: 'API Balance',
        },
        store: {
            local: 'Local',
            online: 'Online',
            title: 'Title',
            description: 'Description',
            clearStoreConfirm: 'Whether to clear the data?',
            importPlaceholder: 'Please paste the JSON data here',
            addRepeatTitleTips: 'Title duplicate, please re-enter',
            addRepeatContentTips: 'Content duplicate: {msg}, please re-enter',
            editRepeatTitleTips: 'Title conflict, please revise',
            editRepeatContentTips: 'Content conflict {msg} , please re-modify',
            importError: 'Key value mismatch',
            importRepeatTitle: 'Title repeatedly skipped: {msg}',
            importRepeatContent: 'Content is repeatedly skipped: {msg}',
            onlineImportWarning: 'Note: Please check the JSON file source!',
            downloadError: 'Please check the network status and JSON file validity',
        },
    }

    zhCN = {
        left: {
            addChat: '新建聊天',
            newChat: '新的聊天',
            noChat: '暂无数据',
            promptStore: '提示存储',
            noMessage: 'Aha~',
        },
        common: {
            add: '添加',
            addSuccess: '添加成功',
            edit: '编辑',
            editSuccess: '编辑成功',
            delete: '删除',
            deleteSuccess: '删除成功',
            save: '保存',
            saveSuccess: '保存成功',
            reset: '重置',
            action: '操作',
            export: '导出',
            exportSuccess: '导出成功',
            import: '导入',
            importSuccess: '导入成功',
            clear: '清空',
            clearSuccess: '清空成功',
            yes: '是',
            no: '否',
            confirm: '确定',
            download: '下载',
            noData: '暂无数据',
            wrong: '好像出错了，请稍后再试。',
            success: '操作成功',
            failed: '操作失败',
            verify: '验证',
            unauthorizedTips: '未经授权，请先进行验证。',
        },
        chat: {
            placeholder: '来说点什么吧...（Shift + Enter = 换行）',
            placeholderMobile: '来说点什么...',
            copy: '复制',
            copied: '复制成功',
            copyCode: '复制代码',
            clearChat: '清空会话',
            stopChat: '停止响应',
            clearChatConfirm: '是否清空会话?',
            exportImage: '保存会话到图片',
            exportImageConfirm: '是否将会话保存为图片?',
            exportSuccess: '保存成功',
            exportFailed: '保存失败',
            usingContext: '上下文模式',
            turnOnContext: '当前模式下, 发送消息会携带之前的聊天记录',
            turnOffContext: '当前模式下, 发送消息不会携带之前的聊天记录',
            deleteMessage: '删除消息',
            deleteMessageConfirm: '是否删除此消息?',
            deleteHistoryConfirm: '确定删除此记录?',
            clearHistoryConfirm: '确定清空聊天记录?',
            preview: '预览',
            showRawText: '显示原文',
        },
        setting: {
            setting: '设置',
            general: '总览',
            advanced: '高级',
            config: '配置',
            avatarLink: '头像链接',
            name: '名称',
            description: '描述',
            role: '角色设定',
            resetUserInfo: '重置用户信息',
            chatHistory: '聊天记录',
            theme: '主题',
            language: '语言',
            api: 'API',
            reverseProxy: '反向代理',
            timeout: '超时',
            socks: 'Socks',
            httpsProxy: 'HTTPS Proxy',
            balance: 'API余额',
        },
        store: {
            local: '本地',
            online: '在线',
            title: '标题',
            description: '描述',
            clearStoreConfirm: '是否清空数据？',
            importPlaceholder: '请粘贴 JSON 数据到此处',
            addRepeatTitleTips: '标题重复，请重新输入',
            addRepeatContentTips: '内容重复：{msg}，请重新输入',
            editRepeatTitleTips: '标题冲突，请重新修改',
            editRepeatContentTips: '内容冲突{msg} ，请重新修改',
            importError: '键值不匹配',
            importRepeatTitle: '标题重复跳过：{msg}',
            importRepeatContent: '内容重复跳过：{msg}',
            onlineImportWarning: '注意：请检查 JSON 文件来源！',
            downloadError: '请检查网络状态与 JSON 文件有效性',
        },
    }

    zhTW = {
        left: {
            addChat: '新增對話',
            newChat: '新的對話',
            noChat: '暫無數據',
            promptStore: '儲存提示',
            noMessage: 'Aha~',
        },
        common: {
            add: '新增',
            addSuccess: '新增成功',
            edit: '編輯',
            editSuccess: '編輯成功',
            delete: '刪除',
            deleteSuccess: '刪除成功',
            save: '儲存',
            saveSuccess: '儲存成功',
            reset: '重設',
            action: '操作',
            export: '匯出',
            exportSuccess: '匯出成功',
            import: '匯入',
            importSuccess: '匯入成功',
            clear: '清除',
            clearSuccess: '清除成功',
            yes: '是',
            no: '否',
            confirm: '確認',
            download: '下載',
            noData: '暫無數據',
            wrong: '發生錯誤，請稍後再試。',
            success: '操作成功',
            failed: '操作失敗',
            verify: '驗證',
            unauthorizedTips: '未經授權，請先進行驗證。',
        },
        chat: {
            placeholder: '來說點什麼...（Shift + Enter = 換行）',
            placeholderMobile: '來說點什麼...',
            copy: '複製',
            copied: '複製成功',
            copyCode: '複製代碼',
            clearChat: '清除對話',
            stopChat: '停止回應',
            clearChatConfirm: '是否清空對話?',
            exportImage: '儲存對話為圖片',
            exportImageConfirm: '是否將對話儲存為圖片?',
            exportSuccess: '儲存成功',
            exportFailed: '儲存失敗',
            usingContext: '上下文模式',
            turnOnContext: '啟用上下文模式，在此模式下，發送訊息會包含之前的聊天記錄。',
            turnOffContext: '關閉上下文模式，在此模式下，發送訊息不會包含之前的聊天記錄。',
            deleteMessage: '刪除訊息',
            deleteMessageConfirm: '是否刪除此訊息?',
            deleteHistoryConfirm: '確定刪除此紀錄?',
            clearHistoryConfirm: '確定清除紀錄?',
            preview: '預覽',
            showRawText: '顯示原文',
        },
        setting: {
            setting: '設定',
            general: '總覽',
            advanced: '高級',
            config: '設定',
            avatarLink: '頭貼連結',
            name: '名稱',
            description: '描述',
            role: '角色設定',
            resetUserInfo: '重設使用者資訊',
            chatHistory: '紀錄',
            theme: '主題',
            language: '語言',
            api: 'API',
            reverseProxy: '反向代理',
            timeout: '逾時',
            socks: 'Socks',
            httpsProxy: 'HTTPS Proxy',
            balance: 'API余額',
        },
        store: {
            local: '本機',
            online: '線上',
            title: '標題',
            description: '描述',
            clearStoreConfirm: '是否清除資料？',
            importPlaceholder: '請將 JSON 資料貼在此處',
            addRepeatTitleTips: '標題重複，請重新輸入',
            addRepeatContentTips: '內容重複：{msg}，請重新輸入',
            editRepeatTitleTips: '標題衝突，請重新修改',
            editRepeatContentTips: '內容衝突{msg} ，請重新修改',
            importError: '鍵值不符合',
            importRepeatTitle: '因標題重複跳過：{msg}',
            importRepeatContent: '因內容重複跳過：{msg}',
            onlineImportWarning: '注意：請檢查 JSON 檔案來源！',
            downloadError: '請檢查網路狀態與 JSON 檔案有效性',
        },
    }

    constructor() {}
    getLanguage(str){
        switch (str) {
            case 'en-US':
                return this.enUS
            case 'zh-CN':
                return this.zhCN
            case 'zh-TW':
                return this.zhTW
            default:
                return this.zhCN
        }
    }
}

let theStorage = function () {

    /**
     * 设置键值对
     * @param key 键
     * @param data 数据
     * @param expire 到期时间s,缺省时不会到期
     */
    function set(key, data, expire) {
        const val = {
            data,
            expire: expire ? new Date().getTime() + expire * 1000 : null
        }
        window.localStorage.setItem(key, JSON.stringify(val))

    }

    // 查询
    function get(key) {
        const json = window.localStorage.getItem(key)
        if (json) {

            let { data, expire } =  JSON.parse(json)
            if (!expire && expire < Date.now()) {
                return null
            }
            return data
        }
    }

    // 移除
    function remove(key) {
        window.localStorage.removeItem(key)
    }

    // 查询+移除
    function acquire(key){
        let data = select(key)
        remove(key)
        return data
    }

    // 清空
    function clear() {
        window.localStorage.clear()
    }

    return { set , get, acquire, remove, clear}
}


let def_user_avatar = './img/user_avatar1.png'
let def_chat_avatar = './img/'
let language = 'zh-CN'                          // 语言默认
let theme = null                                // 默认主题: darkTheme 深色 null浅色






let getNaiveLanguage = function () {
    switch (language) {
        case 'en-US': return naive.enUS
        case 'zh-CN': return naive.zhCN
        case 'zh-TW': return naive.zhTW
        default: return naive.enUS
    }
}

let getLanguage = function() {
    return new UseN18().getLanguage(language)
}

let locale = getNaiveLanguage()




let main = {
    def_user_avatar, def_chat_avatar, language, theme, locale,

    getNaiveLanguage, getLanguage, theStorage
}




